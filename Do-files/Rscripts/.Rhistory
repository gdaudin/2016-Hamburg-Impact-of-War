library(ggthemes)
library(tidyverse)
library(whoami)
library(zoo)
loadfonts()
if(username()=="Tirindelli"){
HamburgPaperDir = "/Users/Tirindelli/Desktop/HamburgPaper/"
HamburgDir = "/Volumes/GoogleDrive/My Drive/Hamburg/"
}
RscriptDir = "Do-files/Rscripts/"
GraphDir = "Graphs/"
DataframeDir = "Dataframe/"
NewgraphsDir = "New graphs/"
PaperDir = "Paper - Impact of War/Paper/"
loss = read.csv(paste(HamburgDir,"database_csv/mean_annual_loss.csv", sep = ""))
loss = loss[c("year", "loss", "loss_nomemory" )]
colony_loss = read.csv(paste(HamburgDir,"database_csv/colony_loss.csv", sep = ""))
colony_loss = colony_loss[c("year", "weight_france")]
naval_sup = read.csv(paste(HamburgDir,"database_csv/naval_supremacy.csv", sep = ""))
naval_sup = naval_sup[c("year", "France_vs_GB", "ally_vs_foe", "allyandneutral_vs_foe")]
prizes = read.csv(paste(HamburgDir,"database_csv/prizes.csv", sep = ""))
prizes = prizes[c("year", "Number_of_prizes_Total_All",
"Number_of_prizes_Privateers_All", "importofprizegoodspoundsterling")]
hotelling = read.csv(paste(HamburgDir,"database_csv/temp_for_hotelling.csv", sep = ""))
war_strat = left_join(loss, colony_loss, by = "year")
war_strat = left_join(war_strat, naval_sup, by = "year")
war_strat = left_join(war_strat, prizes, by = "year")
names(war_strat)[names(war_strat) == "importofprizegoodspoundsterling"] = "prizes_import"
names(war_strat)[names(war_strat) == "Number_of_prizes_Total_All"] = "num_prizes"
names(war_strat)[names(war_strat) == "Number_of_prizes_Privateers_All"] = "num_prizes_priv"
names(war_strat)[names(war_strat) == "weight_france"] = "colony_loss"
fwartime_corr_df = function(fwar_strat, findep){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
fwar_strat = fwar_strat[fwar_strat$war==1,]
m = lm(fwar_strat$loss~fwar_strat$findep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
indep_var = c("prizes_import", "num_prizes", "num_prizes_priv", "colony_loss", "France_vs_GB",
"ally_vs_foe", "allyandneutral_vs_foe")
dflist = list(
fwartime_corr_df(war_strat, "prizes_import"),
fwartime_corr_df(war_strat, "num_prizes"),
fwartime_corr_df(war_strat, "num_prizes_priv"),
fwartime_corr_df(war_strat, "colony_loss"),
fwartime_corr_df(war_strat, "France_vs_GB"),
fwartime_corr_df(war_strat, "ally_vs_foe"),
fwartime_corr_df(war_strat, "allyandneutral_vs_foe")
)
wartime_corr = bind_rows(dflist)
View(war_strat)
war_strat = left_join(loss, colony_loss, by = "year")
war_strat = left_join(war_strat, naval_sup, by = "year")
war_strat = left_join(war_strat, prizes, by = "year")
names(war_strat)[names(war_strat) == "importofprizegoodspoundsterling"] = "prizes_import"
names(war_strat)[names(war_strat) == "Number_of_prizes_Total_All"] = "num_prizes"
names(war_strat)[names(war_strat) == "Number_of_prizes_Privateers_All"] = "num_prizes_priv"
names(war_strat)[names(war_strat) == "weight_france"] = "colony_loss"
war_strat$Wcut= cut(war_strat$year,
breaks=c(1739,1748,1755,1763,1777,1783, 1792, 1807,1815, 1840),
labels = FALSE)
war_strat$war = ifelse(((war_strat$Wcut %% 2) == 0), 0, 1)
war_strat$war = ifelse((war_strat$Wcut == 9), 0, war_strat$war)
war_strat$war = ifelse((war_strat$Wcut == 8), 1, war_strat$war)
fwartime_corr_df = function(fwar_strat, findep){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
fwar_strat = fwar_strat[fwar_strat$war==1,]
m = lm(fwar_strat$loss~fwar_strat$findep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
indep_var = c("prizes_import", "num_prizes", "num_prizes_priv", "colony_loss", "France_vs_GB",
"ally_vs_foe", "allyandneutral_vs_foe")
dflist = list(
fwartime_corr_df(war_strat, "prizes_import"),
fwartime_corr_df(war_strat, "num_prizes"),
fwartime_corr_df(war_strat, "num_prizes_priv"),
fwartime_corr_df(war_strat, "colony_loss"),
fwartime_corr_df(war_strat, "France_vs_GB"),
fwartime_corr_df(war_strat, "ally_vs_foe"),
fwartime_corr_df(war_strat, "allyandneutral_vs_foe")
)
wartime_corr = bind_rows(dflist)
View(wartime_corr)
Dwar_strat = war_strat
Dwar_strat = Dwar_strat %>% group_by(Wcut) %>% mutate(counter = row_number())
f = function(x){
#x = na.locf(x)
x = ifelse(is.na(x), 0, x)
x = cumsum(x)
x = ifelse(Dwar_strat$war ==0, x*exp(-Dwar_strat$counter), x)
}
Dwar_strat[indep_var] = lapply(Dwar_strat[indep_var], f)
dflist = list(
fwartime_corr_df(Dwar_strat, "prizes_import"),
fwartime_corr_df(Dwar_strat, "num_prizes"),
fwartime_corr_df(Dwar_strat, "num_prizes_priv"),
fwartime_corr_df(Dwar_strat, "colony_loss"),
fwartime_corr_df(Dwar_strat, "France_vs_GB"),
fwartime_corr_df(Dwar_strat, "ally_vs_foe"),
fwartime_corr_df(Dwar_strat, "allyandneutral_vs_foe")
)
Dwartime_corr = bind_rows(dflist)
View(Dwartime_corr)
x = Dwar_strat$num_prizes
Dwar_strat$num_prizes = ifelse(is.na(Dwar_strat$num_prizes), 0, Dwar_strat$num_prizes)
View(Dwar_strat)
View(war_strat)
View(Dwar_strat)
Dwar_strat = war_strat
Dwar_strat = Dwar_strat %>% group_by(Wcut) %>% mutate(counter = row_number())
View(Dwar_strat)
fwartime_corr_df = function(fwar_strat, findep, fonlywar){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1) fwar_strat = fwar_strat[fwar_strat$war==1,]
m = lm(fwar_strat$loss~fwar_strat$findep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
head(letters)
head(letters, n=1)
ead(letters, n = -6L)
head(letters, n = -6L)
k=5
sum(0.9**(k-1:k)*head(value,k))
sum(0.9**(k-1:k)*head(x,k))
sum(0.9*(k-1:k)*head(x,k))
0.9**(k-1:k)
k
(k-1:k)
Dwar_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head("num_prizes",k)))]
Dwar_strat[,DCS=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head("num_prizes",k)))]
DCS=sapply(Dwar_strat$num_prizes,function(k) sum(0.9**(k-1:k)*head("num_prizes",k)))
library("data.table")
setDT(data)
setDT(war_strat)
class(war_strat)
war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head("num_prizes",k)))]
war_strat$num_prizes = ifelse(is.na(war_strat$num_prizes), 0, war_strat$num_prizes)
war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head("num_prizes",k)))]
dt <- data.table( "year" = c(79,80,81,82,83), "value" = c(5,2,6,8,9))
dt[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(value,k)))]
war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
war_strat = war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
library(dplyr)
library(ggplot2)
library(ggpubr)
library(extrafont)
library(ggthemes)
library(tidyverse)
library(whoami)
library(zoo)
loadfonts()
if(username()=="Tirindelli"){
HamburgPaperDir = "/Users/Tirindelli/Desktop/HamburgPaper/"
HamburgDir = "/Volumes/GoogleDrive/My Drive/Hamburg/"
}
RscriptDir = "Do-files/Rscripts/"
GraphDir = "Graphs/"
DataframeDir = "Dataframe/"
NewgraphsDir = "New graphs/"
PaperDir = "Paper - Impact of War/Paper/"
loss = read.csv(paste(HamburgDir,"database_csv/mean_annual_loss.csv", sep = ""))
loss = loss[c("year", "loss", "loss_nomemory" )]
colony_loss = read.csv(paste(HamburgDir,"database_csv/colony_loss.csv", sep = ""))
colony_loss = colony_loss[c("year", "weight_france")]
naval_sup = read.csv(paste(HamburgDir,"database_csv/naval_supremacy.csv", sep = ""))
naval_sup = naval_sup[c("year", "France_vs_GB", "ally_vs_foe", "allyandneutral_vs_foe")]
prizes = read.csv(paste(HamburgDir,"database_csv/prizes.csv", sep = ""))
prizes = prizes[c("year", "Number_of_prizes_Total_All",
"Number_of_prizes_Privateers_All", "importofprizegoodspoundsterling")]
hotelling = read.csv(paste(HamburgDir,"database_csv/temp_for_hotelling.csv", sep = ""))
war_strat = left_join(loss, colony_loss, by = "year")
war_strat = left_join(war_strat, naval_sup, by = "year")
war_strat = left_join(war_strat, prizes, by = "year")
names(war_strat)[names(war_strat) == "importofprizegoodspoundsterling"] = "prizes_import"
names(war_strat)[names(war_strat) == "Number_of_prizes_Total_All"] = "num_prizes"
names(war_strat)[names(war_strat) == "Number_of_prizes_Privateers_All"] = "num_prizes_priv"
names(war_strat)[names(war_strat) == "weight_france"] = "colony_loss"
war_strat$Wcut= cut(war_strat$year,
breaks=c(1739,1748,1755,1763,1777,1783, 1792, 1807,1815, 1840),
labels = FALSE)
war_strat$war = ifelse(((war_strat$Wcut %% 2) == 0), 0, 1)
war_strat$war = ifelse((war_strat$Wcut == 9), 0, war_strat$war)
war_strat$war = ifelse((war_strat$Wcut == 8), 1, war_strat$war)
fwartime_corr_df = function(fwar_strat, findep, fonlywar){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1) fwar_strat = fwar_strat[fwar_strat$war==1,]
m = lm(fwar_strat$loss~fwar_strat$findep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
indep_var = c("prizes_import", "num_prizes", "num_prizes_priv", "colony_loss", "France_vs_GB",
"ally_vs_foe", "allyandneutral_vs_foe")
dflist = list(
fwartime_corr_df(war_strat, "prizes_import",1),
fwartime_corr_df(war_strat, "num_prizes",1),
fwartime_corr_df(war_strat, "num_prizes_priv",1),
fwartime_corr_df(war_strat, "colony_loss",1),
fwartime_corr_df(war_strat, "France_vs_GB",1),
fwartime_corr_df(war_strat, "ally_vs_foe",1),
fwartime_corr_df(war_strat, "allyandneutral_vs_foe",1)
)
wartime_corr = bind_rows(dflist)
Dwar_strat = war_strat
dt <- data.table( "year" = c(79,80,81,82,83), "value" = c(5,2,6,8,9))
library("data.table")
dt <- data.table( "year" = c(79,80,81,82,83), "value" = c(5,2,6,8,9))
dt[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(value,k)))]
dt = dt[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(value,k)))]
da = dt[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(value,k)))]
Dwar_strat = war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head("num_prizes",k)))]
Dwar_strat = war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
war_strat = data.table(war_strat)
Dwar_strat = war_strat[,DCS:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
Dwar_strat = war_strat[,num_prizes:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
x = num_prizes:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))
help(":=")
Dwar_strat = war_strat[,num_prizes:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
war_strat$num_prizes = ifelse(is.na(war_strat$num_prizes ), 0, war_strat$num_prizes )
rm(Dwar_strat)
Dwar_strat = war_strat[,num_prizes:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(num_prizes,k)))]
rm(list = ls())
library(dplyr)
library(ggplot2)
library(ggpubr)
library(extrafont)
library(ggthemes)
library(tidyverse)
library(whoami)
library(zoo)
library(data.table)
if(username()=="Tirindelli"){
HamburgPaperDir = "/Users/Tirindelli/Desktop/HamburgPaper/"
HamburgDir = "/Volumes/GoogleDrive/My Drive/Hamburg/"
}
RscriptDir = "Do-files/Rscripts/"
GraphDir = "Graphs/"
DataframeDir = "Dataframe/"
NewgraphsDir = "New graphs/"
PaperDir = "Paper - Impact of War/Paper/"
loss = read.csv(paste(HamburgDir,"database_csv/mean_annual_loss.csv", sep = ""))
loss = loss[c("year", "loss", "loss_nomemory" )]
colony_loss = read.csv(paste(HamburgDir,"database_csv/colony_loss.csv", sep = ""))
colony_loss = colony_loss[c("year", "weight_france")]
naval_sup = read.csv(paste(HamburgDir,"database_csv/naval_supremacy.csv", sep = ""))
naval_sup = naval_sup[c("year", "France_vs_GB", "ally_vs_foe", "allyandneutral_vs_foe")]
prizes = read.csv(paste(HamburgDir,"database_csv/prizes.csv", sep = ""))
prizes = prizes[c("year", "Number_of_prizes_Total_All",
"Number_of_prizes_Privateers_All", "importofprizegoodspoundsterling")]
hotelling = read.csv(paste(HamburgDir,"database_csv/temp_for_hotelling.csv", sep = ""))
#merge loss function db with wartime strageties db
war_strat = left_join(loss, colony_loss, by = "year")
war_strat = left_join(war_strat, naval_sup, by = "year")
war_strat = left_join(war_strat, prizes, by = "year")
#rename variables
names(war_strat)[names(war_strat) == "importofprizegoodspoundsterling"] = "prizes_import"
names(war_strat)[names(war_strat) == "Number_of_prizes_Total_All"] = "num_prizes"
names(war_strat)[names(war_strat) == "Number_of_prizes_Privateers_All"] = "num_prizes_priv"
names(war_strat)[names(war_strat) == "weight_france"] = "colony_loss"
#create war variable
war_strat$Wcut= cut(war_strat$year,
breaks=c(1739,1748,1755,1763,1777,1783, 1792, 1807,1815, 1840),
labels = FALSE)
war_strat$war = ifelse(((war_strat$Wcut %% 2) == 0), 0, 1)
war_strat$war = ifelse((war_strat$Wcut == 9), 0, war_strat$war)
war_strat$war = ifelse((war_strat$Wcut == 8), 1, war_strat$war)
findep = war_strat$num_prizes
fwar_strat = war_strat
fonlywar=1
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
fonlywar = 1
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
findep = "num_prizes"
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
fonlywar = 0
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
indep_var = c("prizes_import", "num_prizes", "num_prizes_priv", "colony_loss", "France_vs_GB",
"ally_vs_foe", "allyandneutral_vs_foe")
#apply function to all wartime strategies var of interest
dflist = list(
fwartime_corr_df(war_strat, "prizes_import",1),
fwartime_corr_df(war_strat, "num_prizes",1),
fwartime_corr_df(war_strat, "num_prizes_priv",1),
fwartime_corr_df(war_strat, "colony_loss",1),
fwartime_corr_df(war_strat, "France_vs_GB",1),
fwartime_corr_df(war_strat, "ally_vs_foe",1),
fwartime_corr_df(war_strat, "allyandneutral_vs_foe",1)
)
#make a df with results
wartime_corr = bind_rows(dflist)
fwartime_corr_df = function(fwar_strat, findep, fonlywar){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
indep_var = c("prizes_import", "num_prizes", "num_prizes_priv", "colony_loss", "France_vs_GB",
"ally_vs_foe", "allyandneutral_vs_foe")
#apply function to all wartime strategies var of interest
dflist = list(
fwartime_corr_df(war_strat, "prizes_import",1),
fwartime_corr_df(war_strat, "num_prizes",1),
fwartime_corr_df(war_strat, "num_prizes_priv",1),
fwartime_corr_df(war_strat, "colony_loss",1),
fwartime_corr_df(war_strat, "France_vs_GB",1),
fwartime_corr_df(war_strat, "ally_vs_foe",1),
fwartime_corr_df(war_strat, "allyandneutral_vs_foe",1)
)
wartime_corr = bind_rows(dflist)
View(wartime_corr)
dflist = list(
fwartime_corr_df(war_strat, "prizes_import",0),
fwartime_corr_df(war_strat, "num_prizes",0),
fwartime_corr_df(war_strat, "num_prizes_priv",0),
fwartime_corr_df(war_strat, "colony_loss",0),
fwartime_corr_df(war_strat, "France_vs_GB",0),
fwartime_corr_df(war_strat, "ally_vs_foe",0),
fwartime_corr_df(war_strat, "allyandneutral_vs_foe",0)
)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(extrafont)
library(ggthemes)
library(tidyverse)
library(whoami)
library(zoo)
library(data.table)
if(username()=="Tirindelli"){
HamburgPaperDir = "/Users/Tirindelli/Desktop/HamburgPaper/"
HamburgDir = "/Volumes/GoogleDrive/My Drive/Hamburg/"
}
RscriptDir = "Do-files/Rscripts/"
GraphDir = "Graphs/"
DataframeDir = "Dataframe/"
NewgraphsDir = "New graphs/"
PaperDir = "Paper - Impact of War/Paper/"
loss = read.csv(paste(HamburgDir,"database_csv/mean_annual_loss.csv", sep = ""))
loss = loss[c("year", "loss", "loss_nomemory" )]
colony_loss = read.csv(paste(HamburgDir,"database_csv/colony_loss.csv", sep = ""))
colony_loss = colony_loss[c("year", "weight_france")]
naval_sup = read.csv(paste(HamburgDir,"database_csv/naval_supremacy.csv", sep = ""))
naval_sup = naval_sup[c("year", "France_vs_GB", "ally_vs_foe", "allyandneutral_vs_foe")]
prizes = read.csv(paste(HamburgDir,"database_csv/prizes.csv", sep = ""))
prizes = prizes[c("year", "Number_of_prizes_Total_All",
"Number_of_prizes_Privateers_All", "importofprizegoodspoundsterling")]
hotelling = read.csv(paste(HamburgDir,"database_csv/temp_for_hotelling.csv", sep = ""))
#merge loss function db with wartime strageties db
war_strat = left_join(loss, colony_loss, by = "year")
war_strat = left_join(war_strat, naval_sup, by = "year")
war_strat = left_join(war_strat, prizes, by = "year")
#rename variables
names(war_strat)[names(war_strat) == "importofprizegoodspoundsterling"] = "prizes_import"
names(war_strat)[names(war_strat) == "Number_of_prizes_Total_All"] = "num_prizes"
names(war_strat)[names(war_strat) == "Number_of_prizes_Privateers_All"] = "num_prizes_priv"
names(war_strat)[names(war_strat) == "weight_france"] = "colony_loss"
#create war variable
war_strat$Wcut= cut(war_strat$year,
breaks=c(1739,1748,1755,1763,1777,1783, 1792, 1807,1815, 1840),
labels = FALSE)
war_strat$war = ifelse(((war_strat$Wcut %% 2) == 0), 0, 1)
war_strat$war = ifelse((war_strat$Wcut == 9), 0, war_strat$war)
war_strat$war = ifelse((war_strat$Wcut == 8), 1, war_strat$war)
fwartime_corr_df = function(fwar_strat, findep, fonlywar){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
fwartime_corr_df(war_strat, "prizes_import",0)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(extrafont)
library(ggthemes)
library(tidyverse)
library(whoami)
library(zoo)
library(data.table)
if(username()=="Tirindelli"){
HamburgPaperDir = "/Users/Tirindelli/Desktop/HamburgPaper/"
HamburgDir = "/Volumes/GoogleDrive/My Drive/Hamburg/"
}
RscriptDir = "Do-files/Rscripts/"
GraphDir = "Graphs/"
DataframeDir = "Dataframe/"
NewgraphsDir = "New graphs/"
PaperDir = "Paper - Impact of War/Paper/"
loss = read.csv(paste(HamburgDir,"database_csv/mean_annual_loss.csv", sep = ""))
loss = loss[c("year", "loss", "loss_nomemory" )]
colony_loss = read.csv(paste(HamburgDir,"database_csv/colony_loss.csv", sep = ""))
colony_loss = colony_loss[c("year", "weight_france")]
naval_sup = read.csv(paste(HamburgDir,"database_csv/naval_supremacy.csv", sep = ""))
naval_sup = naval_sup[c("year", "France_vs_GB", "ally_vs_foe", "allyandneutral_vs_foe")]
prizes = read.csv(paste(HamburgDir,"database_csv/prizes.csv", sep = ""))
prizes = prizes[c("year", "Number_of_prizes_Total_All",
"Number_of_prizes_Privateers_All", "importofprizegoodspoundsterling")]
hotelling = read.csv(paste(HamburgDir,"database_csv/temp_for_hotelling.csv", sep = ""))
#merge loss function db with wartime strageties db
war_strat = left_join(loss, colony_loss, by = "year")
war_strat = left_join(war_strat, naval_sup, by = "year")
war_strat = left_join(war_strat, prizes, by = "year")
#rename variables
names(war_strat)[names(war_strat) == "importofprizegoodspoundsterling"] = "prizes_import"
names(war_strat)[names(war_strat) == "Number_of_prizes_Total_All"] = "num_prizes"
names(war_strat)[names(war_strat) == "Number_of_prizes_Privateers_All"] = "num_prizes_priv"
names(war_strat)[names(war_strat) == "weight_france"] = "colony_loss"
#create war variable
war_strat$Wcut= cut(war_strat$year,
breaks=c(1739,1748,1755,1763,1777,1783, 1792, 1807,1815, 1840),
labels = FALSE)
war_strat$war = ifelse(((war_strat$Wcut %% 2) == 0), 0, 1)
war_strat$war = ifelse((war_strat$Wcut == 9), 0, war_strat$war)
war_strat$war = ifelse((war_strat$Wcut == 8), 1, war_strat$war)
fwar_strat = war_strat
findep = "num_prizes"
fonlywar = 0
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
fwartime_corr_df = function(fwar_strat, findep, fonlywar){
names(fwar_strat)[names(fwar_strat) == findep] = "findep"
if(fonlywar == 1){
fwar_strat = fwar_strat[fwar_strat$war==1,]
fwar_strat$Dfindep = fwar_strat$findep
}else{
findep = ifelse(is.na(findep), 0, findep)
fwar_strat = setDT(fwar_strat)
fwar_strat = fwar_strat[,Dfindep:=sapply(1:.N,function(k) sum(0.9**(k-1:k)*head(findep,k)))]
}
m = lm(fwar_strat$loss~fwar_strat$Dfindep)
df = data.frame(
"var" = findep,
"corr" = round(m$coefficients[2], 3),
"pval" = round(summary(m)$coefficients[2,4], 3)
)
}
fwartime_corr_df(war_strat, "num_prizes",0)
fwartime_corr_df(war_strat, "prizes_import",0)
