TTWA  = read.csv(paste(DriveDir,databases_csvDir,"TTWA","GB.csv", sep = ""), header = TRUE)
LGD  = read.csv(paste(DriveDir,databases_csvDir,"GB.csv", sep = ""), header = TRUE)
GB = data.frame(rbind(
fgini_df(PUA, "PUA"),
fgini_df(UA2011, "UA2011"),
fgini_df(TTWA, "TTWA"),
fgini_df(LGD, "LGD")))
gini_coeff = aggregate(pop ~ unit + year,
data = GB,
FUN = "gini")
gini_coeff_wide = reshape(gini_coeff, idvar = "year",
timevar = "unit", direction = "wide")
gini_coeff = data.frame(rbind(
cbind(
aggregate(pop ~ unit + year,
data = GB[(GB$pop > GB$CSN) & !(is.na(GB$pop)),],
FUN = "gini"),
"cutoff" = "CSN"),
cbind(
aggregate(pop ~ unit + year,
data = GB[(GB$pop > GB$GI) & !(is.na(GB$pop)),],
FUN = "gini"),
"cutoff" = "GI"),
cbind(
aggregate(pop ~ unit + year,
data = GB[(GB$pop > GB$Level) & !(is.na(GB$pop)),],
FUN = "gini"),
"cutoff" = "Level"),
cbind(
aggregate(pop ~ unit + year,
data = GB[(GB$pop > GB$Extreme) & !(is.na(GB$pop)),],
FUN = "gini"),
"cutoff" = "Extreme")
))
write.csv(paste(DriveDir, PreliminaryGBDir,databases_csvDir, "gini_coeff.csv", sep = ""))
write.csv(gini_coeff, paste(DriveDir, PreliminaryGBDir,databases_csvDir, "gini_coeff.csv", sep = ""), row.names = FALSE)
write.csv(gini_coeff, paste(DriveDir,databases_csvDir, "gini_coeff.csv", sep = ""), row.names = FALSE)
rm(list = ls())
library(magrittr)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggpubr)
library(mgcv)
library(np)
library(tidyverse)
library(lspline)
library(xtable)
library(stringi)
DriveDir = "/Volumes/GoogleDrive/My Drive/"
databases_csvDir = "PhD/Data/GB/databases_csv/"
PreliminaryGBDir = "PhD/Tex/PreliminaryGB/NewGraphs/"
RscriptDir = "PhD/Data/GB/Rscript/GB/"
To_create_datasetDir="To create dataset/"
To_create_graphsDir="To create graphs/"
aux_functionDir="aux_function/"
RscriptUnitDir = "UA2011/"
ResultsDir = "PhD/Tex/Results/"
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fgrowth_rate_size.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fG_size_long.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plotlist.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plot.R", sep = "" ))
source(paste(DriveDir,RscriptDir,aux_functionDir,"f_df.R", sep = "" ))
LGDGBwide = read.csv(paste(DriveDir, databases_csvDir,"GBwide.csv", sep = ""), header = TRUE)
UAGBwide = read.csv(paste(DriveDir, databases_csvDir,"UA2011","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide = read.csv(paste(DriveDir, databases_csvDir,"PUA","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide_summary = PUAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
PUAGBwide_1801_2011 = PUAGBwide[c("town", "pop1801", "pop2011")]
LGDg_size_wide = fgrowth_rate_size(LGDGBwide, TRUE, FALSE, FALSE, "")
UAg_size_wide = fgrowth_rate_size(UAGBwide, TRUE, FALSE, FALSE, "UA2011")
PUAg_size_wide = fgrowth_rate_size(PUAGBwide, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_summary = fgrowth_rate_size(PUAGBwide_summary, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_1801_2011 = fgrowth_rate_size(PUAGBwide_1801_2011, TRUE, FALSE, FALSE, "PUA")
g_size_long = rbind(
f_df(LGDg_size_wide, "", "clauset", "CSN", "LGD"),
f_df(LGDg_size_wide, "", "gi", "GI", "LGD"),
f_df(LGDg_size_wide, "", "extreme", "Extreme", "LGD"),
f_df(LGDg_size_wide, "", "level", "Level", "LGD"),
f_df(UAg_size_wide, "UA2011", "clauset", "CSN", "UA"),
f_df(UAg_size_wide, "UA2011", "gi", "GI", "UA"),
f_df(UAg_size_wide, "UA2011", "extreme", "Extreme", "UA"),
f_df(UAg_size_wide, "UA2011", "level", "Level", "UA"),
f_df(PUAg_size_wide, "PUA", "clauset", "CSN", "PUA"),
f_df(PUAg_size_wide, "PUA", "gi", "GI", "PUA"),
f_df(PUAg_size_wide, "PUA", "extreme", "Extreme", "PUA"),
f_df(PUAg_size_wide, "PUA", "level", "Level", "PUA")
)
fkernel_reg_plotlist(g_size_long, "LGD", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelLGDallcutoff.pdf", sep = ""))
fkernel_reg_plotlist(g_size_long, "UA", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelUAallcutoff.pdf", sep = ""))
fkernel_reg_plotlist(g_size_long, "PUA", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelPUAallcutoff.pdf", sep = ""))
fkernel_reg_plot(g_size_long, "LGD", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "clauset", "CSN", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "CSN")
kernel_summary = kernel_summary +
scale_x_continuous(labels = function(x){return(round(exp(x)/1000,0))})
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "summary.pdf", sep = ""))
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "clauset", "CSN", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "CSN")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
print(kernel_1801_2011)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011.pdf", sep = ""))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
rm(list = ls())
library(magrittr)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggpubr)
library(mgcv)
library(np)
library(tidyverse)
library(lspline)
library(xtable)
library(stringi)
DriveDir = "/Volumes/GoogleDrive/My Drive/"
databases_csvDir = "PhD/Data/GB/databases_csv/"
PreliminaryGBDir = "PhD/Tex/PreliminaryGB/NewGraphs/"
RscriptDir = "PhD/Data/GB/Rscript/GB/"
To_create_datasetDir="To create dataset/"
To_create_graphsDir="To create graphs/"
aux_functionDir="aux_function/"
RscriptUnitDir = "UA2011/"
ResultsDir = "PhD/Tex/Results/"
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fgrowth_rate_size.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fG_size_long.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plotlist.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plot.R", sep = "" ))
source(paste(DriveDir,RscriptDir,aux_functionDir,"f_df.R", sep = "" ))
LGDGBwide = read.csv(paste(DriveDir, databases_csvDir,"GBwide.csv", sep = ""), header = TRUE)
UAGBwide = read.csv(paste(DriveDir, databases_csvDir,"UA2011","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide = read.csv(paste(DriveDir, databases_csvDir,"PUA","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide_summary = PUAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
PUAGBwide_1801_2011 = PUAGBwide[c("town", "pop1801", "pop2011")]
LGDg_size_wide = fgrowth_rate_size(LGDGBwide, TRUE, FALSE, FALSE, "")
UAg_size_wide = fgrowth_rate_size(UAGBwide, TRUE, FALSE, FALSE, "UA2011")
PUAg_size_wide = fgrowth_rate_size(PUAGBwide, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_summary = fgrowth_rate_size(PUAGBwide_summary, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_1801_2011 = fgrowth_rate_size(PUAGBwide_1801_2011, TRUE, FALSE, FALSE, "PUA")
g_size_long = rbind(
f_df(LGDg_size_wide, "", "clauset", "CSN", "LGD"),
f_df(LGDg_size_wide, "", "gi", "GI", "LGD"),
f_df(LGDg_size_wide, "", "extreme", "Extreme", "LGD"),
f_df(LGDg_size_wide, "", "level", "Level", "LGD"),
f_df(UAg_size_wide, "UA2011", "clauset", "CSN", "UA"),
f_df(UAg_size_wide, "UA2011", "gi", "GI", "UA"),
f_df(UAg_size_wide, "UA2011", "extreme", "Extreme", "UA"),
f_df(UAg_size_wide, "UA2011", "level", "Level", "UA"),
f_df(PUAg_size_wide, "PUA", "clauset", "CSN", "PUA"),
f_df(PUAg_size_wide, "PUA", "gi", "GI", "PUA"),
f_df(PUAg_size_wide, "PUA", "extreme", "Extreme", "PUA"),
f_df(PUAg_size_wide, "PUA", "level", "Level", "PUA")
)
fkernel_reg_plotlist(g_size_long, "LGD", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelLGDallcutoff.pdf", sep = ""))
fkernel_reg_plotlist(g_size_long, "UA", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelUAallcutoff.pdf", sep = ""))
fkernel_reg_plotlist(g_size_long, "PUA", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelPUAallcutoff.pdf", sep = ""))
fkernel_reg_plot(g_size_long, "LGD", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "clauset", "CSN", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "CSN")
kernel_summary = kernel_summary +
scale_x_continuous(labels = function(x){return(round(exp(x)/1000,0))})
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "summary.pdf", sep = ""))
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "clauset", "CSN", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "CSN")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
print(kernel_1801_2011)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011.pdf", sep = ""))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
rm(list = ls())
library(magrittr)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggpubr)
library(mgcv)
library(np)
library(tidyverse)
library(lspline)
library(xtable)
library(stringi)
DriveDir = "/Volumes/GoogleDrive/My Drive/"
databases_csvDir = "PhD/Data/GB/databases_csv/"
PreliminaryGBDir = "PhD/Tex/PreliminaryGB/NewGraphs/"
RscriptDir = "PhD/Data/GB/Rscript/GB/"
To_create_datasetDir="To create dataset/"
To_create_graphsDir="To create graphs/"
aux_functionDir="aux_function/"
RscriptUnitDir = "UA2011/"
ResultsDir = "PhD/Tex/Results/"
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fgrowth_rate_size.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fG_size_long.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plotlist.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plot.R", sep = "" ))
source(paste(DriveDir,RscriptDir,aux_functionDir,"f_df.R", sep = "" ))
LGDGBwide = read.csv(paste(DriveDir, databases_csvDir,"GBwide.csv", sep = ""), header = TRUE)
UAGBwide = read.csv(paste(DriveDir, databases_csvDir,"UA2011","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide = read.csv(paste(DriveDir, databases_csvDir,"PUA","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide_summary = PUAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
PUAGBwide_1801_2011 = PUAGBwide[c("town", "pop1801", "pop2011")]
LGDg_size_wide = fgrowth_rate_size(LGDGBwide, TRUE, FALSE, FALSE, "")
UAg_size_wide = fgrowth_rate_size(UAGBwide, TRUE, FALSE, FALSE, "UA2011")
PUAg_size_wide = fgrowth_rate_size(PUAGBwide, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_summary = fgrowth_rate_size(PUAGBwide_summary, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_1801_2011 = fgrowth_rate_size(PUAGBwide_1801_2011, TRUE, FALSE, FALSE, "PUA")
g_size_long = rbind(
f_df(LGDg_size_wide, "", "clauset", "CSN", "LGD"),
f_df(LGDg_size_wide, "", "gi", "GI", "LGD"),
f_df(LGDg_size_wide, "", "extreme", "Extreme", "LGD"),
f_df(LGDg_size_wide, "", "level", "Level", "LGD"),
f_df(UAg_size_wide, "UA2011", "clauset", "CSN", "UA"),
f_df(UAg_size_wide, "UA2011", "gi", "GI", "UA"),
f_df(UAg_size_wide, "UA2011", "extreme", "Extreme", "UA"),
f_df(UAg_size_wide, "UA2011", "level", "Level", "UA"),
f_df(PUAg_size_wide, "PUA", "clauset", "CSN", "PUA"),
f_df(PUAg_size_wide, "PUA", "gi", "GI", "PUA"),
f_df(PUAg_size_wide, "PUA", "extreme", "Extreme", "PUA"),
f_df(PUAg_size_wide, "PUA", "level", "Level", "PUA")
)
fkernel_reg_plotlist(g_size_long, "LGD", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelLGDallcutoff.pdf", sep = ""))
fkernel_reg_plotlist(g_size_long, "UA", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelUAallcutoff.pdf", sep = ""))
fkernel_reg_plotlist(g_size_long, "PUA", "cutoff")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernelPUAallcutoff.pdf", sep = ""))
fkernel_reg_plot(g_size_long, "LGD", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "LGD", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "LGD", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "UA", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "GI")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "GI", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "Extreme")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "extreme", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
fkernel_reg_plot(g_size_long, "PUA", "Level")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "level", ".pdf", sep = ""), units = "cm", width = 25, height = 35)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "clauset", "CSN", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "CSN")
kernel_summary = kernel_summary +
scale_x_continuous(labels = function(x){return(round(exp(x)/1000,0))})
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "summary.pdf", sep = ""))
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "clauset", "CSN", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "CSN")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
print(kernel_1801_2011)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011.pdf", sep = ""))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
rm(list = ls())
library(magrittr)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggpubr)
library(mgcv)
library(np)
library(tidyverse)
library(lspline)
library(xtable)
library(stringi)
DriveDir = "/Volumes/GoogleDrive/My Drive/"
databases_csvDir = "PhD/Data/GB/databases_csv/"
PreliminaryGBDir = "PhD/Tex/PreliminaryGB/NewGraphs/"
RscriptDir = "PhD/Data/GB/Rscript/GB/"
To_create_datasetDir="To create dataset/"
To_create_graphsDir="To create graphs/"
aux_functionDir="aux_function/"
RscriptUnitDir = "UA2011/"
ResultsDir = "PhD/Tex/Results/"
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fgrowth_rate_size.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fG_size_long.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plotlist.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plot.R", sep = "" ))
source(paste(DriveDir,RscriptDir,aux_functionDir,"f_df.R", sep = "" ))
LGDGBwide = read.csv(paste(DriveDir, databases_csvDir,"GBwide.csv", sep = ""), header = TRUE)
UAGBwide = read.csv(paste(DriveDir, databases_csvDir,"UA2011","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide = read.csv(paste(DriveDir, databases_csvDir,"PUA","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide_summary = PUAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
PUAGBwide_1801_2011 = PUAGBwide[c("town", "pop1801", "pop2011")]
LGDg_size_wide = fgrowth_rate_size(LGDGBwide, TRUE, FALSE, FALSE, "")
UAg_size_wide = fgrowth_rate_size(UAGBwide, TRUE, FALSE, FALSE, "UA2011")
PUAg_size_wide = fgrowth_rate_size(PUAGBwide, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_summary = fgrowth_rate_size(PUAGBwide_summary, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_1801_2011 = fgrowth_rate_size(PUAGBwide_1801_2011, TRUE, FALSE, FALSE, "PUA")
g_size_long = rbind(
f_df(LGDg_size_wide, "", "clauset", "CSN", "LGD"),
f_df(LGDg_size_wide, "", "gi", "GI", "LGD"),
f_df(LGDg_size_wide, "", "extreme", "Extreme", "LGD"),
f_df(LGDg_size_wide, "", "level", "Level", "LGD"),
f_df(UAg_size_wide, "UA2011", "clauset", "CSN", "UA"),
f_df(UAg_size_wide, "UA2011", "gi", "GI", "UA"),
f_df(UAg_size_wide, "UA2011", "extreme", "Extreme", "UA"),
f_df(UAg_size_wide, "UA2011", "level", "Level", "UA"),
f_df(PUAg_size_wide, "PUA", "clauset", "CSN", "PUA"),
f_df(PUAg_size_wide, "PUA", "gi", "GI", "PUA"),
f_df(PUAg_size_wide, "PUA", "extreme", "Extreme", "PUA"),
f_df(PUAg_size_wide, "PUA", "level", "Level", "PUA")
)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "gi", "GI", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "GI")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "gi", "GI", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "GI")
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "gi", "GI", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "GI")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "gi", "GI", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "GI")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "GI", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "extreme", "Extreme", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "Extreme")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "extreme", "Extreme", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "Extreme")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "level", "Level", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "Level")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "level", "Level", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "Level")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "Level", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "level", "Level", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "Level")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "level", "Level", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "Level")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.003))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "Level", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "extreme", "Extreme", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "Extreme")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "extreme", "Extreme", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "Extreme")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "Extreme", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "extreme", "Extreme", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "Extreme")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "extreme", "Extreme", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "Extreme")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.003))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "Extreme", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
g_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "gi", "GI", "PUA")
kernel_summary = fkernel_reg_plot(g_size_long_summary, "PUA", "GI")
g_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "gi", "GI", "PUA")
kernel_1801_2011 = fkernel_reg_plot(g_size_long_1801_2011, "PUA", "GI")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "GI", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
View(fgrowth_rate_size)
LGDGBwide = read.csv(paste(DriveDir, databases_csvDir,"GBwide.csv", sep = ""), header = TRUE)
UAGBwide = read.csv(paste(DriveDir, databases_csvDir,"UA2011","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide = read.csv(paste(DriveDir, databases_csvDir,"PUA","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide_summary = PUAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
PUAGBwide_1801_2011 = PUAGBwide[c("town", "pop1801", "pop2011")]
UAGBwide_summary = UAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
UAGBwide_1801_2011 = UAGBwide[c("town", "pop1801", "pop2011")]
LGDg_size_wide = fgrowth_rate_size(LGDGBwide, TRUE, FALSE, FALSE, "")
UAg_size_wide = fgrowth_rate_size(UAGBwide, TRUE, FALSE, FALSE, "UA2011")
PUAg_size_wide = fgrowth_rate_size(PUAGBwide, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_summary = fgrowth_rate_size(PUAGBwide_summary, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_1801_2011 = fgrowth_rate_size(PUAGBwide_1801_2011, TRUE, FALSE, FALSE, "PUA")
UAg_size_wide_summary = fgrowth_rate_size(UAGBwide_summary, TRUE, FALSE, FALSE, "UA")
UAg_size_wide_1801_2011 = fgrowth_rate_size(UAGBwide_1801_2011, TRUE, FALSE, FALSE, "UA")
View(f_df)
View(fg_size_long)
g_size_long_summary = f_df(UAg_size_wide_summary, "UA2011", "clauset", "CSN", "UA")
rm(list = ls())
library(magrittr)
library(dplyr)
library(ggplot2)
library(ggforce)
library(ggpubr)
library(mgcv)
library(np)
library(tidyverse)
library(lspline)
library(xtable)
library(stringi)
DriveDir = "/Volumes/GoogleDrive/My Drive/"
databases_csvDir = "PhD/Data/GB/databases_csv/"
PreliminaryGBDir = "PhD/Tex/PreliminaryGB/NewGraphs/"
RscriptDir = "PhD/Data/GB/Rscript/GB/"
To_create_datasetDir="To create dataset/"
To_create_graphsDir="To create graphs/"
aux_functionDir="aux_function/"
RscriptUnitDir = "UA2011/"
ResultsDir = "PhD/Tex/Results/"
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fgrowth_rate_size.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_datasetDir,"fG_size_long.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plotlist.R", sep = "" ))
source(paste(DriveDir,RscriptDir,To_create_graphsDir,"fkernel_reg_plot.R", sep = "" ))
source(paste(DriveDir,RscriptDir,aux_functionDir,"f_df.R", sep = "" ))
LGDGBwide = read.csv(paste(DriveDir, databases_csvDir,"GBwide.csv", sep = ""), header = TRUE)
UAGBwide = read.csv(paste(DriveDir, databases_csvDir,"UA2011","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide = read.csv(paste(DriveDir, databases_csvDir,"PUA","GBwide.csv", sep = ""), header = TRUE)
PUAGBwide_summary = PUAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
PUAGBwide_1801_2011 = PUAGBwide[c("town", "pop1801", "pop2011")]
UAGBwide_summary = UAGBwide[c("town", "pop1801", "pop1861", "pop1911", "pop1951", "pop2011")]
UAGBwide_1801_2011 = UAGBwide[c("town", "pop1801", "pop2011")]
LGDg_size_wide = fgrowth_rate_size(LGDGBwide, TRUE, FALSE, FALSE, "")
UAg_size_wide = fgrowth_rate_size(UAGBwide, TRUE, FALSE, FALSE, "UA2011")
PUAg_size_wide = fgrowth_rate_size(PUAGBwide, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_summary = fgrowth_rate_size(PUAGBwide_summary, TRUE, FALSE, FALSE, "PUA")
PUAg_size_wide_1801_2011 = fgrowth_rate_size(PUAGBwide_1801_2011, TRUE, FALSE, FALSE, "PUA")
UAg_size_wide_summary = fgrowth_rate_size(UAGBwide_summary, TRUE, FALSE, FALSE, "UA")
UAg_size_wide_1801_2011 = fgrowth_rate_size(UAGBwide_1801_2011, TRUE, FALSE, FALSE, "UA")
PUAg_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "clauset", "CSN", "PUA")
kernel_summary = fkernel_reg_plot(PUAg_size_long_summary, "PUA", "CSN")
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "summary.pdf", sep = ""))
PUAg_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "clauset", "CSN", "PUA")
kernel_1801_2011 = fkernel_reg_plot(PUAg_size_long_1801_2011, "PUA", "CSN")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
print(kernel_1801_2011)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "PUA", "CSN", "1801_2011.pdf", sep = ""))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
PUAg_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "gi", "GI", "PUA")
kernel_summary = fkernel_reg_plot(PUAg_size_long_summary, "PUA", "GI")
PUAg_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "gi", "GI", "PUA")
kernel_1801_2011 = fkernel_reg_plot(PUAg_size_long_1801_2011, "PUA", "GI")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
PUAg_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "extreme", "Extreme", "PUA")
kernel_summary = fkernel_reg_plot(PUAg_size_long_summary, "PUA", "Extreme")
PUAg_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "extreme", "Extreme", "PUA")
kernel_1801_2011 = fkernel_reg_plot(PUAg_size_long_1801_2011, "PUA", "Extreme")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.003))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
PUAg_size_long_summary = f_df(PUAg_size_wide_summary, "PUA", "level", "Level", "PUA")
kernel_summary = fkernel_reg_plot(PUAg_size_long_summary, "PUA", "Level")
PUAg_size_long_1801_2011 = f_df(PUAg_size_wide_1801_2011, "PUA", "level", "Level", "PUA")
kernel_1801_2011 = fkernel_reg_plot(PUAg_size_long_1801_2011, "PUA", "Level")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.003))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
UAg_size_long_summary = f_df(UAg_size_wide_summary, "UA2011", "clauset", "CSN", "UA")
kernel_summary = fkernel_reg_plot(UAg_size_long_summary, "UA", "CSN")
UAg_size_long_1801_2011 = f_df(UAg_size_wide_1801_2011, "UA2011", "clauset", "CSN", "UA")
kernel_1801_2011 = fkernel_reg_plot(UAg_size_long_1801_2011, "UA", "CSN")
kernel_1801_2011 = kernel_1801_2011 + ylim(c(0,0.004))
ggarrange(kernel_1801_2011, kernel_summary, nrow = 2)
ggsave(paste(DriveDir, PreliminaryGBDir, "kernel", "UA", "CSN", "1801_2011summary.pdf", sep = ""), units = "cm", width = 17, height = 20)
View(f_df)
View(fg_size_long)
LGDg_size_long_summary = f_df(LGDg_size_wide_summary, "", "clauset", "CSN", "LGD")
